<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OptiM v1 Beta - Tienda de Programas Mat√≠as Taibo</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<!-- SDK de PayPal -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_CLIENT_ID&currency=USD" data-sdk-integration-source="button-factory"></script>
<!-- SDK de MercadoPago -->
<script src="https://sdk.mercadopago.com/js/v2"></script>
<meta name="theme-color" content="#0f1724">
<style>
:root{--accent1:#ff6b6b;--accent2:#feca57;--primary-bg:#081421}
*{box-sizing:border-box}
body{font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;margin:0;background:linear-gradient(135deg,#081421 0%,#072033 100%);color:#e6eef8;min-height:100vh}
.navbar{backdrop-filter:blur(8px);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
.brand{font-weight:800}
.hero{padding:80px 20px;text-align:center;background:linear-gradient(135deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:18px;margin:24px auto;width:92%;box-shadow:0 20px 60px rgba(2,6,23,0.6)}
.lead{color:var(--accent2)}
.search-container{max-width:820px;margin:20px auto}
.section-title{font-size:1.8rem;margin-bottom:18px}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;border:1px solid rgba(255,255,255,0.03);color:#eaf6ff;transition:transform 0.3s, box-shadow 0.3s}
.card:hover{transform:translateY(-5px);box-shadow:0 15px 30px rgba(0,0,0,0.4)}
.btn-primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;border-radius:999px;padding:10px 20px;font-weight:700}
.btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.06);border-radius:999px}
.launcher{background:linear-gradient(135deg,#1f005c,#5b0060);padding:24px;border-radius:12px;margin-top:22px}
.pulse{animation:pulse 2.2s infinite}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
.footer{background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(0,0,0,0.9));padding:30px;text-align:center;margin-top:40px}
.glass-card{background:rgba(255,255,255,0.02);padding:16px;border-radius:12px}
.login-card{width:480px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.15));padding:20px;border-radius:12px}
.muted{color:rgba(255,255,255,0.65)}
.small-muted{color:rgba(255,255,255,0.5);font-size:0.9rem}
.payment-modal{position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:10000;display:flex;align-items:center;justify-content:center;padding:20px;overflow-y:auto}
.payment-card{width:100%;max-width:600px;background:linear-gradient(180deg,rgba(30,30,40,0.95),rgba(15,15,25,0.98));border-radius:16px;padding:25px;border:1px solid rgba(255,255,255,0.05)}
.token-display{background:linear-gradient(90deg,rgba(255,107,107,0.1),rgba(254,202,87,0.1));padding:15px;border-radius:10px;margin:15px 0;font-family:monospace;font-size:1.1rem;text-align:center;letter-spacing:1px;word-break:break-all}
.success-check{color:#4caf50;font-size:3rem;margin:20px 0}
.payment-step{padding:12px;border-left:3px solid var(--accent1);margin:10px 0;background:rgba(255,255,255,0.02)}
.price-tag{font-size:2rem;font-weight:bold;background:linear-gradient(90deg,var(--accent1),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.payment-method-card{border:2px solid transparent;border-radius:10px;padding:15px;cursor:pointer;transition:all 0.3s}
.payment-method-card:hover{border-color:var(--accent1);background:rgba(255,255,255,0.05)}
.payment-method-card.active{border-color:var(--accent2);background:rgba(254,202,87,0.1)}
.country-flag{width:24px;height:24px;border-radius:50%;margin-right:10px}
.product-badge{position:absolute;top:10px;right:10px;background:var(--accent1);color:white;padding:5px 10px;border-radius:20px;font-size:0.8rem}
.cart-badge{position:absolute;top:-5px;right:-5px;background:var(--accent2);color:#000;border-radius:50%;width:20px;height:20px;font-size:0.8rem;display:flex;align-items:center;justify-content:center}
.shop-container{max-width:1200px;margin:0 auto}
@media (max-width:768px){.hero{padding:40px 12px}.login-card{width:100%}.payment-card{padding:15px}}
</style>
</head>
<body>

<!-- NAV -->
<nav class="navbar navbar-expand-lg navbar-dark px-4">
  <div class="container-fluid">
    <a class="navbar-brand brand text-light"><i class="fas fa-bolt"></i> OptiM Shop</a>
    <div class="d-flex gap-2 align-items-center">
      <div class="position-relative me-2">
        <button class="btn btn-outline text-light" id="cartBtn">
          <i class="fas fa-shopping-cart"></i> Carrito
        </button>
        <span id="cartCount" class="cart-badge" style="display:none">0</span>
      </div>
      <button class="btn btn-outline text-light" id="openAdminBtn"><i class="fas fa-tools"></i> Admin</button>
      <button class="btn btn-outline text-light" id="openMemberBtn"><i class="fas fa-crown"></i> Membres√≠a</button>
      <a class="btn btn-outline text-light" href="#contacto-info"><i class="fas fa-envelope"></i> Contacto</a>
    </div>
  </div>
</nav>

<!-- CARRITO FLOTANTE -->
<div id="cartSidebar" style="display:none;position:fixed;right:0;top:0;width:350px;height:100vh;background:linear-gradient(180deg,#0c1a2d,#081421);z-index:9997;padding:20px;box-shadow:-5px 0 20px rgba(0,0,0,0.5);overflow-y:auto">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4><i class="fas fa-shopping-cart"></i> Tu Carrito</h4>
    <button class="btn btn-sm btn-outline text-light" onclick="toggleCart()">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div id="cartItems"></div>
  <div class="mt-3 pt-3 border-top border-secondary">
    <div class="d-flex justify-content-between mb-2">
      <span>Subtotal:</span>
      <span id="cartSubtotal">$0.00</span>
    </div>
    <div class="d-flex justify-content-between mb-3">
      <span>Total:</span>
      <span class="fw-bold" id="cartTotal">$0.00</span>
    </div>
    <button class="btn btn-primary w-100 mb-2" onclick="proceedToCheckout()">
      <i class="fas fa-lock"></i> Proceder al Pago
    </button>
    <button class="btn btn-outline w-100" onclick="clearCart()">
      <i class="fas fa-trash"></i> Vaciar Carrito
    </button>
  </div>
</div>

<!-- HERO -->
<section class="hero container">
  <h1 class="display-5">OptiM Shop ‚Äî v1 Beta <small class="small-muted">(2025) ‚Äî Creado por Mat√≠as Taibo</small></h1>
  <p class="lead">Tienda oficial de programas y membres√≠as premium. Paga como prefieras: <strong>PayPal, MercadoPago, transferencias internacionales</strong>. Todo llega directo a mi CVU personal.</p>
  <div class="search-container">
    <input id="searchInput" class="form-control form-control-lg" placeholder="Buscar programas, apps o membres√≠as..." aria-label="Buscar">
  </div>
  <div class="d-flex justify-content-center gap-3 mt-3">
    <a class="btn btn-primary" id="ctaLauncher"><i class="fas fa-magic"></i> Abrir Grimoire Rev</a>
    <a class="btn btn-outline text-light" id="ctaExplore"><i class="fas fa-compass"></i> Explorar Tienda</a>
  </div>
</section>

<!-- TIENDA PRINCIPAL -->
<section class="container py-5" id="tienda">
  <h2 class="section-title">üè™ Tienda OptiM</h2>
  <div class="row g-4" id="productosContainer"></div>
</section>

<!-- LAUNCHER -->
<div class="container mt-4">
  <div class="launcher d-flex flex-column align-items-center text-light">
    <h3><i class="fas fa-rocket"></i> Grimoire Rev ‚Äî Mejorado (AQW)</h3>
    <p class="small-muted">Launcher dedicado para mejorar la experiencia de AQW: m√≥dulos de optimizaci√≥n, skins y arranque r√°pido. (Integrado en OptiM).</p>
    <div class="d-flex gap-2 flex-wrap justify-content-center mt-3">
      <button class="btn btn-primary" id="openLauncherUI"><i class="fas fa-desktop"></i> Abrir Launcher</button>
      <button class="btn btn-outline text-light" id="openSettings"><i class="fas fa-sliders-h"></i> Ajustes</button>
    </div>
  </div>
</div>

<!-- MEMBRES√çAS PREMIUM -->
<section class="container py-5" id="membresias">
  <h2 class="section-title">üëë Membres√≠as Premium</h2>
  <p class="text-center mb-4 small-muted">Acceso completo a todos los programas + contenido exclusivo</p>
  <div class="row g-4">
    <!-- Plan Free -->
    <div class="col-md-4">
      <div class="card p-4 h-100">
        <div class="text-center mb-3">
          <h4 class="mb-1">Free</h4>
          <div class="price-tag">$0</div>
          <small class="small-muted">Acceso b√°sico</small>
        </div>
        <ul class="list-unstyled">
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Programas b√°sicos</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Actualizaciones</li>
          <li class="mb-2"><i class="fas fa-times text-muted me-2"></i> Contenido exclusivo</li>
          <li class="mb-2"><i class="fas fa-times text-muted me-2"></i> Soporte prioritario</li>
        </ul>
        <button class="btn btn-outline w-100 mt-3" onclick="addToCart('free')">Seleccionar</button>
      </div>
    </div>
    
    <!-- Plan Plus -->
    <div class="col-md-4">
      <div class="card p-4 h-100 position-relative">
        <span class="product-badge">M√ÅS POPULAR</span>
        <div class="text-center mb-3">
          <h4 class="mb-1">Plus</h4>
          <div class="price-tag">$9.99<span class="fs-6">/mes</span></div>
          <small class="small-muted">o $99.99/a√±o (ahorra 16%)</small>
        </div>
        <ul class="list-unstyled">
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Todo el contenido Free</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Acceso anticipado</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> 5 skins exclusivas</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Soporte prioritario</li>
        </ul>
        <button class="btn btn-primary w-100 mt-3" onclick="addToCart('plus-monthly')">Suscribirse Mensual</button>
        <button class="btn btn-outline w-100 mt-2" onclick="addToCart('plus-yearly')">Suscribirse Anual</button>
      </div>
    </div>
    
    <!-- Plan Elite -->
    <div class="col-md-4">
      <div class="card p-4 h-100">
        <div class="text-center mb-3">
          <h4 class="mb-1">Elite</h4>
          <div class="price-tag">$19.99<span class="fs-6">/mes</span></div>
          <small class="small-muted">o $199.99/a√±o (ahorra 16%)</small>
        </div>
        <ul class="list-unstyled">
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Todo el contenido Plus</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Todas las skins (20+)</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Soporte VIP 24/7</li>
          <li class="mb-2"><i class="fas fa-check text-success me-2"></i> Acceso de por vida (beta)</li>
        </ul>
        <button class="btn btn-primary w-100 mt-3" onclick="addToCart('elite-monthly')">Suscribirse Mensual</button>
        <button class="btn btn-outline w-100 mt-2" onclick="addToCart('elite-yearly')">Suscribirse Anual</button>
      </div>
    </div>
  </div>
</section>

<!-- PAGOS INTERNACIONALES -->
<section class="container py-5" id="pagosInternacionales">
  <h2 class="section-title">üåç Pagos Internacionales</h2>
  <p class="text-center mb-4 small-muted">Para usuarios fuera de Argentina. El dinero siempre llega a mi cuenta personal.</p>
  
  <div class="row g-4">
    <!-- PayPal -->
    <div class="col-md-6">
      <div class="card p-4 h-100">
        <div class="text-center mb-3">
          <i class="fab fa-paypal fa-3x mb-3" style="color:#003087"></i>
          <h4>PayPal</h4>
          <p class="small-muted">Pago seguro internacional</p>
        </div>
        <div class="mb-3">
          <h6>Beneficios:</h6>
          <ul class="small">
            <li>Protegido por PayPal</li>
            <li>Reembolsos disponibles</li>
            <li>Pago en USD/EUR</li>
            <li>Procesamiento instant√°neo</li>
          </ul>
        </div>
        <button class="btn btn-primary w-100" onclick="selectPaymentMethod('paypal')">
          <i class="fab fa-paypal me-2"></i>Pagar con PayPal
        </button>
      </div>
    </div>
    
    <!-- Transferencia Internacional -->
    <div class="col-md-6">
      <div class="card p-4 h-100">
        <div class="text-center mb-3">
          <i class="fas fa-globe-americas fa-3x mb-3" style="color:#feca57"></i>
          <h4>Transferencia Internacional</h4>
          <p class="small-muted">Para bancos extranjeros</p>
        </div>
        <div class="mb-3">
          <h6>Instrucciones:</h6>
          <ul class="small">
            <li>Transferencia SWIFT/IBAN</li>
            <li>Datos bancarios argentinos</li>
            <li>Env√≠a comprobante por email</li>
            <li>Token manual en 24hs</li>
          </ul>
        </div>
        <button class="btn btn-outline w-100" onclick="showBankDetails()">
          <i class="fas fa-university me-2"></i>Ver Datos Bancarios
        </button>
      </div>
    </div>
  </div>
  
  <!-- Otras opciones -->
  <div class="mt-4">
    <h5 class="mb-3">Otras opciones de pago:</h5>
    <div class="d-flex flex-wrap gap-2">
      <button class="btn btn-outline" onclick="showMercadoPago()">
        <i class="fas fa-dollar-sign me-2"></i>MercadoPago (Argentina)
      </button>
      <button class="btn btn-outline" onclick="showCrypto()">
        <i class="fas fa-coins me-2"></i>Crypto (USDT, Bitcoin)
      </button>
      <button class="btn btn-outline" onclick="showBrubank()">
        <i class="fas fa-mobile-alt me-2"></i>Brubank (Argentina)
      </button>
    </div>
  </div>
</section>

<!-- MODAL DE CHECKOUT -->
<div id="checkoutModal" class="payment-modal" style="display:none;">
  <div class="payment-card">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4><i class="fas fa-shopping-bag"></i> Finalizar Compra</h4>
      <button class="btn btn-sm btn-outline text-light" onclick="closeCheckout()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div id="checkoutContent">
      <!-- Contenido din√°mico del checkout -->
    </div>
  </div>
</div>

<!-- MODAL DATOS BANCARIOS -->
<div id="bankModal" class="payment-modal" style="display:none;">
  <div class="payment-card">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4><i class="fas fa-university"></i> Datos Bancarios</h4>
      <button class="btn btn-sm btn-outline text-light" onclick="closeBankModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="alert alert-dark mb-3">
      <i class="fas fa-info-circle me-2"></i>
      <strong>Importante:</strong> Todo el dinero llega directo a mi CVU personal. Una vez realizada la transferencia, env√≠a el comprobante a matias.taibo2023@gmail.com
    </div>
    
    <div class="row">
      <!-- Argentina -->
      <div class="col-md-6 mb-4">
        <h5 class="mb-3"><img src="https://flagcdn.com/w40/ar.png" class="country-flag"> Argentina</h5>
        <div class="glass-card p-3">
          <div class="mb-2">
            <strong>Banco:</strong> Galicia
          </div>
          <div class="mb-2">
            <strong>Titular:</strong> Mat√≠as Taibo
          </div>
          <div class="mb-2">
            <strong>CVU:</strong> 0000007900000000000000
          </div>
          <div class="mb-2">
            <strong>Alias:</strong> grimoire.tokens
          </div>
          <div>
            <strong>CUIT:</strong> 20-12345678-9
          </div>
        </div>
      </div>
      
      <!-- Internacional -->
      <div class="col-md-6 mb-4">
        <h5 class="mb-3"><i class="fas fa-globe-americas"></i> Internacional</h5>
        <div class="glass-card p-3">
          <div class="mb-2">
            <strong>Banco:</strong> Banco Galicia
          </div>
          <div class="mb-2">
            <strong>SWIFT:</strong> BACOARBAXXX
          </div>
          <div class="mb-2">
            <strong>IBAN:</strong> AR1234567890123456789012
          </div>
          <div class="mb-2">
            <strong>Address:</strong> Tte. Gral. J. D. Per√≥n 407, Buenos Aires
          </div>
          <div>
            <strong>Currency:</strong> USD/ARS
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-3">
      <h6>¬øYa pagaste?</h6>
      <div class="input-group mb-2">
        <input type="email" id="transferEmail" class="form-control" placeholder="Tu email">
        <input type="file" id="transferReceipt" class="form-control" accept="image/*,.pdf">
      </div>
      <button class="btn btn-primary w-100" onclick="uploadTransferReceipt()">
        <i class="fas fa-upload me-2"></i>Enviar Comprobante
      </button>
    </div>
  </div>
</div>

<!-- PREMIUM CONTENT -->
<section class="container py-4" id="premiumContent" style="display:none">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="section-title mb-0">Contenido Exclusivo</h3>
    <div class="badge bg-success px-3 py-2">
      <i class="fas fa-crown me-2"></i>Premium Activo
    </div>
  </div>
  <div class="row">
    <div class="col-md-4"><div class="card p-3"> <h5>Grimoire Rev Pro</h5><p class="muted">M√≥dulos 3D y skins exclusivos.</p></div></div>
    <div class="col-md-4"><div class="card p-3"> <h5>Acceso Anticipado</h5><p class="muted">Prueba apps alpha y betas.</p></div></div>
    <div class="col-md-4"><div class="card p-3"> <h5>Experiencias Interactivas</h5><p class="muted">Mini apps WebGL y visualizaciones premium.</p></div></div>
  </div>
  
  <div class="mt-4">
    <h5>Tu Informaci√≥n Premium</h5>
    <div class="glass-card mt-3">
      <div class="row">
        <div class="col-md-6">
          <div class="mb-2">
            <small class="small-muted">Token:</small>
            <div id="currentToken" class="token-display">-</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="mb-2">
            <small class="small-muted">Plan:</small>
            <div id="currentPlan" class="fs-5">-</div>
          </div>
        </div>
      </div>
      <div class="mt-3">
        <small class="small-muted">Expiraci√≥n:</small>
        <div id="expirationDate" class="fs-6">-</div>
      </div>
    </div>
  </div>
</section>

<!-- ADMIN PANEL -->
<div id="adminPanel" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:9999;align-items:center;justify-content:center;padding:20px">
  <div class="login-card p-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4>Panel Admin ‚Äî OptiM Shop</h4>
      <small class="small-muted">Demo frontend</small>
    </div>
    
    <div id="adminLoginArea">
      <input id="adminPass" class="form-control mb-2" placeholder="Contrase√±a admin" type="password" />
      <div class="d-flex gap-2 mb-3">
        <button class="btn btn-primary" onclick="loginAdmin()">Ingresar</button>
        <button class="btn btn-outline" onclick="closeAdmin()">Cerrar</button>
      </div>
    </div>

    <div id="adminActions" style="display:none">
      <ul class="nav nav-tabs mb-3">
        <li class="nav-item"><button class="nav-link active" onclick="showAdminTab('tokens')">Tokens</button></li>
        <li class="nav-item"><button class="nav-link" onclick="showAdminTab('orders')">Pedidos</button></li>
        <li class="nav-item"><button class="nav-link" onclick="showAdminTab('products')">Productos</button></li>
        <li class="nav-item"><button class="nav-link" onclick="showAdminTab('settings')">Config</button></li>
      </ul>
      
      <!-- Tokens Tab -->
      <div id="tabTokens">
        <h6>Generador de Tokens</h6>
        <div class="d-flex gap-2 mb-2">
          <input id="newTokenInput" class="form-control" placeholder="Etiqueta (ej: OPTIM-ELITE-2025)"/>
          <select id="tokenPlan" class="form-control" style="max-width:120px">
            <option value="plus">Plus</option>
            <option value="elite">Elite</option>
          </select>
          <button class="btn btn-primary" onclick="generarToken()">Generar</button>
        </div>
        <small class="small-muted">Tokens guardados en local (demo).</small>
        <pre id="tokensList" style="max-height:120px;overflow:auto;background:rgba(0,0,0,0.15);padding:10px;border-radius:8px;margin-top:8px"></pre>
        
        <div class="d-flex gap-2 mt-3">
          <button class="btn btn-outline" onclick="exportTokens()">Exportar Tokens</button>
          <button class="btn btn-outline" onclick="clearTokens()">Limpiar Tokens</button>
        </div>
      </div>
      
      <!-- Pedidos Tab -->
      <div id="tabOrders" style="display:none">
        <h6>Pedidos Recientes</h6>
        <div id="ordersList" style="max-height:200px;overflow:auto;background:rgba(0,0,0,0.05);padding:10px;border-radius:8px"></div>
        <div class="d-flex gap-2 mt-2">
          <button class="btn btn-outline" onclick="exportOrders()">Exportar CSV</button>
          <button class="btn btn-outline" onclick="clearOrders()">Limpiar</button>
        </div>
      </div>
      
      <!-- Productos Tab -->
      <div id="tabProducts" style="display:none">
        <h6>Gesti√≥n de Productos</h6>
        <button class="btn btn-primary mb-3" onclick="addProductModal()">
          <i class="fas fa-plus"></i> Agregar Producto
        </button>
        <div id="productsAdminList"></div>
      </div>
      
      <!-- Config Tab -->
      <div id="tabSettings" style="display:none">
        <h6>Configuraci√≥n de Pagos</h6>
        <div class="mb-3">
          <label class="form-label small-muted">Email PayPal</label>
          <input type="email" id="paypalEmail" class="form-control" value="matias.taibo2023@gmail.com">
        </div>
        <div class="mb-3">
          <label class="form-label small-muted">Alias Brubank</label>
          <input type="text" id="brubankAlias" class="form-control" value="grimoire.tokens">
        </div>
        <div class="mb-3">
          <label class="form-label small-muted">MercadoPago Access Token</label>
          <input type="text" id="mpAccessToken" class="form-control" placeholder="TEST-XXXX...">
        </div>
        <button class="btn btn-primary" onclick="savePaymentSettings()">Guardar Configuraci√≥n</button>
      </div>
    </div>
  </div>
</div>

<!-- LAUNCHER UI (mini) -->
<div id="launcherUI" style="display:none;position:fixed;right:20px;bottom:20px;width:360px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.2));padding:12px;border-radius:12px;z-index:9998;box-shadow:0 12px 40px rgba(0,0,0,0.6)">
  <div class="d-flex justify-content-between align-items-center mb-2"><strong>Grimoire Rev - Launcher</strong><div><button class="btn btn-sm btn-outline" onclick="closeLauncherUI()"><i class="fas fa-times"></i></button></div></div>
  <div id="launcherApps" style="max-height:300px;overflow:auto"></div>
  <div class="mt-2 d-flex gap-2"><button class="btn btn-primary w-100" onclick="optimizarSistema()">Optimizar Ahora</button></div>
</div>

<!-- CONTACTO -->
<section id="contacto-info" class="py-5 text-center">
  <h2 class="section-title">Contacto Oficial</h2>
  <p class="small-muted mb-1">Consultas generales o soporte t√©cnico:</p>
  <p class="font-weight-bold">üìß <a href="mailto:matias.taibo2023@gmail.com" class="text-light">matias.taibo2023@gmail.com</a></p>
  <p class="font-weight-bold">üìû 3872252758 (solo emergencias o problemas no solucionables)</p>
  <p class="small-muted mt-3">Para problemas con pagos, incluir ID de transacci√≥n y correo usado.</p>
</section>

<!-- FOOTER -->
<footer class="footer">
  <div class="container d-flex justify-content-between align-items-center">
    <div>¬© 2025 OptiM Shop ‚Äî v1 Beta ‚Äî Mat√≠as Taibo</div>
    <div>
      <a class="text-light me-2" href="#"><i class="fab fa-github"></i></a>
      <a class="text-light" href="#"><i class="fab fa-twitter"></i></a>
    </div>
  </div>
</footer>

<script>
/* ========== CONFIGURACI√ìN INICIAL ========== */
const CONFIG = {
  miCVU: "0000007900000000000000",
  miAlias: "grimoire.tokens",
  miEmail: "matias.taibo2023@gmail.com",
  paypalEmail: "matias.taibo2023@gmail.com",
  // Agregar aqu√≠ tu PUBLIC KEY de MercadoPago
  mercadoPagoPublicKey: "TEST-XXXXXXXXXXXXXXXXXXXXXXXXXXXX"
};

/* ========== PRODUCTOS DE LA TIENDA ========== */
const PRODUCTOS = [
  {
    id: 'plus-monthly',
    nombre: 'Membres√≠a Plus Mensual',
    descripcion: 'Acceso completo por 1 mes',
    precio: 9.99,
    moneda: 'USD',
    tipo: 'membresia',
    categoria: 'premium',
    popular: true
  },
  {
    id: 'elite-monthly',
    nombre: 'Membres√≠a Elite Mensual',
    descripcion: 'Acceso VIP por 1 mes',
    precio: 19.99,
    moneda: 'USD',
    tipo: 'membresia',
    categoria: 'premium'
  },
  {
    id: 'plus-yearly',
    nombre: 'Membres√≠a Plus Anual',
    descripcion: 'Acceso completo por 1 a√±o (16% descuento)',
    precio: 99.99,
    moneda: 'USD',
    tipo: 'membresia',
    categoria: 'premium'
  },
  {
    id: 'elite-yearly',
    nombre: 'Membres√≠a Elite Anual',
    descripcion: 'Acceso VIP por 1 a√±o (16% descuento)',
    precio: 199.99,
    moneda: 'USD',
    tipo: 'membresia',
    categoria: 'premium'
  },
  {
    id: 'swf-pro',
    nombre: 'Descompresor SWF Pro',
    descripcion: 'Versi√≥n profesional con m√°s funciones',
    precio: 14.99,
    moneda: 'USD',
    tipo: 'software',
    categoria: 'herramientas'
  },
  {
    id: 'grimoire-pro',
    nombre: 'Grimoire Rev Pro',
    descripcion: 'Launcher premium con skins exclusivas',
    precio: 24.99,
    moneda: 'USD',
    tipo: 'software',
    categoria: 'aqw',
    popular: true
  },
  {
    id: 'skin-pack-1',
    nombre: 'Pack Skins B√°sico',
    descripcion: '5 skins exclusivas para Grimoire',
    precio: 7.99,
    moneda: 'USD',
    tipo: 'skin',
    categoria: 'aqw'
  },
  {
    id: 'skin-pack-2',
    nombre: 'Pack Skins Premium',
    descripcion: '15 skins exclusivas + efectos',
    precio: 19.99,
    moneda: 'USD',
    tipo: 'skin',
    categoria: 'aqw'
  }
];

/* ========== CARRITO DE COMPRAS ========== */
let carrito = JSON.parse(localStorage.getItem('optim_cart')) || [];
let ordenActual = null;

function actualizarCarrito() {
  localStorage.setItem('optim_cart', JSON.stringify(carrito));
  
  // Actualizar badge
  const cartCount = document.getElementById('cartCount');
  if (carrito.length > 0) {
    cartCount.textContent = carrito.length;
    cartCount.style.display = 'flex';
  } else {
    cartCount.style.display = 'none';
  }
  
  // Actualizar sidebar si est√° visible
  if (document.getElementById('cartSidebar').style.display === 'block') {
    renderCartItems();
  }
}

function addToCart(productId) {
  const producto = PRODUCTOS.find(p => p.id === productId);
  if (!producto) {
    alert('Producto no encontrado');
    return;
  }
  
  carrito.push({
    ...producto,
    cartId: Date.now() + Math.random().toString(36).substr(2, 9)
  });
  
  actualizarCarrito();
  showNotification(`${producto.nombre} agregado al carrito`, 'success');
  
  // Mostrar carrito autom√°ticamente
  toggleCart();
}

function removeFromCart(cartId) {
  carrito = carrito.filter(item => item.cartId !== cartId);
  actualizarCarrito();
}

function clearCart() {
  if (carrito.length === 0) return;
  if (confirm('¬øVaciar todo el carrito?')) {
    carrito = [];
    actualizarCarrito();
    showNotification('Carrito vaciado', 'info');
  }
}

function renderCartItems() {
  const container = document.getElementById('cartItems');
  const subtotal = document.getElementById('cartSubtotal');
  const total = document.getElementById('cartTotal');
  
  if (carrito.length === 0) {
    container.innerHTML = '<div class="text-center py-4"><i class="fas fa-shopping-cart fa-2x mb-3"></i><p class="small-muted">Tu carrito est√° vac√≠o</p></div>';
    subtotal.textContent = '$0.00';
    total.textContent = '$0.00';
    return;
  }
  
  let html = '';
  let sum = 0;
  
  carrito.forEach(item => {
    sum += item.precio;
    html += `
      <div class="d-flex justify-content-between align-items-center mb-3 p-2 border-bottom border-secondary">
        <div style="flex:1">
          <div class="fw-bold">${item.nombre}</div>
          <div class="small-muted">${item.descripcion}</div>
        </div>
        <div class="text-end ms-3">
          <div class="fw-bold">$${item.precio.toFixed(2)} ${item.moneda}</div>
          <button class="btn btn-sm btn-outline mt-1" onclick="removeFromCart('${item.cartId}')">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
  subtotal.textContent = `$${sum.toFixed(2)}`;
  total.textContent = `$${sum.toFixed(2)}`;
}

function toggleCart() {
  const sidebar = document.getElementById('cartSidebar');
  if (sidebar.style.display === 'block') {
    sidebar.style.display = 'none';
  } else {
    sidebar.style.display = 'block';
    renderCartItems();
  }
}

function proceedToCheckout() {
  if (carrito.length === 0) {
    alert('Agrega productos al carrito primero');
    return;
  }
  
  showCheckout();
}

/* ========== CHECKOUT Y PAGOS ========== */
function showCheckout() {
  const modal = document.getElementById('checkoutModal');
  const content = document.getElementById('checkoutContent');
  
  let total = carrito.reduce((sum, item) => sum + item.precio, 0);
  
  content.innerHTML = `
    <div class="payment-step">
      <h6><i class="fas fa-shopping-cart me-2"></i>Resumen de Compra</h6>
      <div style="max-height:200px;overflow-y:auto" class="mt-2">
        ${carrito.map(item => `
          <div class="d-flex justify-content-between mb-2">
            <div>
              <div>${item.nombre}</div>
              <small class="small-muted">${item.descripcion}</small>
            </div>
            <div class="fw-bold">$${item.precio.toFixed(2)}</div>
          </div>
        `).join('')}
      </div>
      <div class="d-flex justify-content-between mt-3 border-top pt-2">
        <strong>Total:</strong>
        <strong class="price-tag">$${total.toFixed(2)} USD</strong>
      </div>
    </div>
    
    <div class="payment-step mt-4">
      <h6><i class="fas fa-user me-2"></i>Informaci√≥n del Cliente</h6>
      <div class="row mt-2">
        <div class="col-md-6 mb-2">
          <input type="email" id="customerEmail" class="form-control" placeholder="Tu email" required>
        </div>
        <div class="col-md-6 mb-2">
          <input type="text" id="customerName" class="form-control" placeholder="Nombre completo">
        </div>
      </div>
    </div>
    
    <div class="payment-step mt-4">
      <h6><i class="fas fa-credit-card me-2"></i>M√©todo de Pago</h6>
      <div class="row g-2 mt-2" id="paymentMethods">
        <div class="col-md-6">
          <div class="payment-method-card" onclick="selectPaymentMethod('paypal')">
            <i class="fab fa-paypal fa-2x mb-2" style="color:#003087"></i>
            <div><strong>PayPal</strong></div>
            <small class="small-muted">Pago internacional seguro</small>
          </div>
        </div>
        <div class="col-md-6">
          <div class="payment-method-card" onclick="selectPaymentMethod('mercadopago')">
            <i class="fas fa-dollar-sign fa-2x mb-2" style="color:#00a1e1"></i>
            <div><strong>MercadoPago</strong></div>
            <small class="small-muted">Argentina y Latinoam√©rica</small>
          </div>
        </div>
        <div class="col-md-6">
          <div class="payment-method-card" onclick="selectPaymentMethod('transferencia')">
            <i class="fas fa-university fa-2x mb-2" style="color:#feca57"></i>
            <div><strong>Transferencia</strong></div>
            <small class="small-muted">Banco o crypto</small>
          </div>
        </div>
        <div class="col-md-6">
          <div class="payment-method-card" onclick="selectPaymentMethod('crypto')">
            <i class="fas fa-coins fa-2x mb-2" style="color:#f7931a"></i>
            <div><strong>Crypto</strong></div>
            <small class="small-muted">USDT, Bitcoin, etc.</small>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-4" id="paymentButtonContainer"></div>
  `;
  
  modal.style.display = 'flex';
  ordenActual = {
    items: [...carrito],
    total: total,
    fecha: new Date().toISOString(),
    id: 'ORD-' + Date.now() + '-' + Math.random().toString(36).substr(2, 6).toUpperCase()
  };
}

function selectPaymentMethod(method) {
  // Remover clase active de todos
  document.querySelectorAll('.payment-method-card').forEach(card => {
    card.classList.remove('active');
  });
  
  // Agregar clase active al seleccionado
  event.target.closest('.payment-method-card').classList.add('active');
  
  const container = document.getElementById('paymentButtonContainer');
  const email = document.getElementById('customerEmail').value;
  const name = document.getElementById('customerName').value;
  
  if (!email) {
    container.innerHTML = '<div class="alert alert-warning">Ingresa tu email primero</div>';
    return;
  }
  
  // Actualizar orden con info del cliente
  ordenActual.email = email;
  ordenActual.name = name;
  
  switch(method) {
    case 'paypal':
      container.innerHTML = `
        <button class="btn btn-primary w-100" onclick="processPayPalPayment()">
          <i class="fab fa-paypal me-2"></i>Pagar con PayPal ($${ordenActual.total.toFixed(2)})
        </button>
        <small class="small-muted d-block mt-2">
          Ser√°s redirigido a PayPal para completar el pago. El dinero llegar√° directo a ${CONFIG.paypalEmail}
        </small>
      `;
      break;
      
    case 'mercadopago':
      container.innerHTML = `
        <button class="btn btn-primary w-100" onclick="processMercadoPagoPayment()">
          <i class="fas fa-dollar-sign me-2"></i>Pagar con MercadoPago ($${ordenActual.total.toFixed(2)})
        </button>
        <small class="small-muted d-block mt-2">
          Pago en pesos argentinos al tipo de cambio oficial. El dinero llega a mi CVU personal.
        </small>
      `;
      break;
      
    case 'transferencia':
      container.innerHTML = `
        <button class="btn btn-outline w-100" onclick="showBankDetails()">
          <i class="fas fa-university me-2"></i>Ver Datos Bancarios
        </button>
        <small class="small-muted d-block mt-2">
          Realiza la transferencia y env√≠a el comprobante. Te enviaremos el token manualmente.
        </small>
      `;
      break;
      
    case 'crypto':
      container.innerHTML = `
        <button class="btn btn-outline w-100" onclick="showCryptoDetails()">
          <i class="fas fa-coins me-2"></i>Ver Direcciones Crypto
        </button>
        <small class="small-muted d-block mt-2">
          Aceptamos USDT (TRC20/ERC20), Bitcoin, y otras criptomonedas.
        </small>
      `;
      break;
  }
}

/* ========== PAYPAL INTEGRATION ========== */
function processPayPalPayment() {
  const container = document.getElementById('paymentButtonContainer');
  container.innerHTML = `
    <div class="text-center py-3">
      <div class="spinner-border text-primary mb-3"></div>
      <p>Inicializando PayPal...</p>
    </div>
  `;
  
  // Simulaci√≥n de integraci√≥n PayPal
  setTimeout(() => {
    simulatePaymentSuccess('paypal');
  }, 2000);
  
  // En producci√≥n, usar:
  // paypal.Buttons({
  //   createOrder: function(data, actions) {
  //     return actions.order.create({
  //       purchase_units: [{
  //         amount: {
  //           value: ordenActual.total.toFixed(2)
  //         }
  //       }]
  //     });
  //   },
  //   onApprove: function(data, actions) {
  //     return actions.order.capture().then(function(details) {
  //       completeOrder('paypal', details.id);
  //     });
  //   }
  // }).render('#paymentButtonContainer');
}

/* ========== MERCADOPAGO INTEGRATION ========== */
function processMercadoPagoPayment() {
  const container = document.getElementById('paymentButtonContainer');
  container.innerHTML = `
    <div class="text-center py-3">
      <div class="spinner-border text-primary mb-3"></div>
      <p>Inicializando MercadoPago...</p>
    </div>
  `;
  
  // Simulaci√≥n de integraci√≥n MercadoPago
  setTimeout(() => {
    simulatePaymentSuccess('mercadopago');
  }, 2000);
  
  // En producci√≥n, usar:
  // const mp = new MercadoPago(CONFIG.mercadoPagoPublicKey);
  // mp.checkout({
  //   preference: {
  //     id: 'ID-DE-PREFERENCIA-GENERADA-EN-BACKEND'
  //   },
  //   autoOpen: true
  // });
}

function simulatePaymentSuccess(method) {
  const token = generarTokenPremium();
  
  // Guardar orden
  const orders = JSON.parse(localStorage.getItem('optim_orders')) || [];
  ordenActual.status = 'completed';
  ordenActual.method = method;
  ordenActual.token = token;
  ordenActual.completedAt = new Date().toISOString();
  orders.push(ordenActual);
  localStorage.setItem('optim_orders', JSON.stringify(orders));
  
  // Guardar token
  const tokens = JSON.parse(localStorage.getItem('optim_tokens_v2')) || [];
  const plan = determinarPlanDesdeCarrito();
  tokens.push({
    token: token,
    plan: plan,
    email: ordenActual.email,
    orderId: ordenActual.id,
    created: new Date().toISOString(),
    expires: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
  });
  localStorage.setItem('optim_tokens_v2', JSON.stringify(tokens));
  
  // Limpiar carrito
  carrito = [];
  actualizarCarrito();
  
  // Mostrar √©xito
  const content = document.getElementById('checkoutContent');
  content.innerHTML = `
    <div class="text-center py-4">
      <div class="success-check">
        <i class="fas fa-check-circle"></i>
      </div>
      <h4 class="mb-3">¬°Pago Exitoso!</h4>
      <p class="small-muted">Tu compra ha sido procesada correctamente.</p>
      
      <div class="alert alert-dark mb-3">
        <i class="fas fa-receipt me-2"></i>
        <strong>Orden #:</strong> ${ordenActual.id}
      </div>
      
      <div class="token-display mt-3 mb-4">
        ${token}
      </div>
      
      <div class="alert alert-success mb-3">
        <i class="fas fa-envelope me-2"></i>
        El token tambi√©n ha sido enviado a: <strong>${ordenActual.email}</strong>
      </div>
      
      <div class="d-grid gap-2">
        <button class="btn btn-primary" onclick="activarPremium('${token}')">
          <i class="fas fa-rocket me-2"></i>Activar Premium Ahora
        </button>
        <button class="btn btn-outline" onclick="closeCheckout()">
          Cerrar
        </button>
      </div>
      
      <div class="mt-4 small-muted">
        <i class="fas fa-info-circle me-1"></i>
        Guarda este token en un lugar seguro.
      </div>
    </div>
  `;
  
  showNotification('¬°Pago completado exitosamente!', 'success');
  
  // Actualizar admin panel si est√° abierto
  if (document.getElementById('adminActions').style.display === 'block') {
    loadOrdersList();
    loadTokensList();
  }
}

function determinarPlanDesdeCarrito() {
  // Determinar el plan basado en los items del carrito
  const tieneElite = carrito.some(item => item.id.includes('elite'));
  const tienePlus = carrito.some(item => item.id.includes('plus'));
  
  if (tieneElite) return 'elite';
  if (tienePlus) return 'plus';
  return 'free';
}

function generarTokenPremium() {
  const planes = {
    'plus': 'OPTIM-PLUS',
    'elite': 'OPTIM-ELITE',
    'free': 'OPTIM-FREE'
  };
  
  const plan = determinarPlanDesdeCarrito();
  const prefix = planes[plan] || 'OPTIM';
  const random = Math.random().toString(36).substr(2, 8).toUpperCase();
  return `${prefix}-${random}-${Date.now().toString(36).substr(-4).toUpperCase()}`;
}

/* ========== FUNCIONES AUXILIARES ========== */
function closeCheckout() {
  document.getElementById('checkoutModal').style.display = 'none';
  ordenActual = null;
}

function showBankDetails() {
  document.getElementById('bankModal').style.display = 'flex';
}

function closeBankModal() {
  document.getElementById('bankModal').style.display = 'none';
}

function showMercadoPago() {
  alert('MercadoPago: Realiza el pago a trav√©s de MercadoPago con el CVU: ' + CONFIG.miCVU + '\n\nAlias: ' + CONFIG.miAlias + '\n\nLuego env√≠a el comprobante a: ' + CONFIG.miEmail);
}

function showCrypto() {
  alert('Crypto: Aceptamos USDT (TRC20), Bitcoin y Ethereum.\n\nEnv√≠a un email a ' + CONFIG.miEmail + ' para obtener las direcciones de wallet.\n\nIndica qu√© criptomoneda prefieres usar.');
}

function showBrubank() {
  alert('Brubank: Realiza la transferencia a:\n\nAlias: ' + CONFIG.miAlias + '\nCVU: ' + CONFIG.miCVU + '\n\nLuego env√≠a el comprobante a: ' + CONFIG.miEmail);
}

function showCryptoDetails() {
  alert('Direcciones Crypto:\n\nUSDT (TRC20): TXXXXXXXXXXXXXXX\nBitcoin: 1XXXXXXXXXXXXXXX\nEthereum: 0xXXXXXXXXXXXXXXX\n\nEnv√≠a el hash de la transacci√≥n a ' + CONFIG.miEmail);
}

function uploadTransferReceipt() {
  const email = document.getElementById('transferEmail').value;
  const file = document.getElementById('transferReceipt').files[0];
  
  if (!email || !file) {
    alert('Completa todos los campos');
    return;
  }
  
  alert('Comprobante recibido. Revisaremos el pago y te enviaremos el token en menos de 24 horas.\n\nEmail registrado: ' + email);
  closeBankModal();
}

/* ========== RENDER PRODUCTOS ========== */
function renderProductos() {
  const container = document.getElementById('productosContainer');
  container.innerHTML = '';
  
  PRODUCTOS.forEach(producto => {
    const col = document.createElement('div');
    col.className = 'col-md-6 col-lg-3';
    col.innerHTML = `
      <div class="card p-3 h-100 position-relative">
        ${producto.popular ? '<span class="product-badge">POPULAR</span>' : ''}
        <div class="text-center mb-3">
          <i class="fas fa-${producto.tipo === 'membresia' ? 'crown' : 'download'} fa-2x mb-3" style="color:var(--accent1)"></i>
          <h5 class="mb-2">${producto.nombre}</h5>
          <p class="small-muted mb-3">${producto.descripcion}</p>
        </div>
        <div class="text-center mb-3">
          <div class="price-tag">$${producto.precio.toFixed(2)} ${producto.moneda}</div>
          ${producto.tipo === 'membresia' ? '<small class="small-muted">Renovaci√≥n autom√°tica</small>' : ''}
        </div>
        <button class="btn btn-primary w-100" onclick="addToCart('${producto.id}')">
          <i class="fas fa-cart-plus me-2"></i>Agregar al Carrito
        </button>
        ${producto.tipo === 'membresia' ? 
          '<button class="btn btn-outline w-100 mt-2" onclick="showPlanDetails(\'' + producto.id + '\')">Ver Detalles</button>' : 
          '<button class="btn btn-outline w-100 mt-2" onclick="downloadTrial(\'' + producto.id + '\')">Probar Demo</button>'
        }
      </div>
    `;
    container.appendChild(col);
  });
}

function showPlanDetails(planId) {
  const plan = PRODUCTOS.find(p => p.id === planId);
  if (!plan) return;
  
  alert(`${plan.nombre}\n\n${plan.descripcion}\n\nPrecio: $${plan.precio} ${plan.moneda}\n\nCaracter√≠sticas:\n‚Ä¢ Acceso completo al contenido\n‚Ä¢ Actualizaciones autom√°ticas\n‚Ä¢ Soporte prioritario\n‚Ä¢ Contenido exclusivo`);
}

function downloadTrial(productId) {
  const product = PRODUCTOS.find(p => p.id === productId);
  if (!product) return;
  
  alert(`Descargando versi√≥n de prueba de: ${product.nombre}\n\nLa versi√≥n de prueba tiene limitaciones. Para desbloquear todas las funciones, adquiere la versi√≥n completa.`);
}

/* ========== NOTIFICACIONES ========== */
function showNotification(message, type = 'info') {
  const notif = document.createElement('div');
  notif.className = `alert alert-${type} position-fixed`;
  notif.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10001;
    min-width: 300px;
    backdrop-filter: blur(10px);
    background: rgba(30,30,40,0.9);
    border: 1px solid rgba(255,255,255,0.1);
    animation: slideIn 0.3s ease-out;
  `;
  
  const icons = {
    success: 'check-circle',
    error: 'times-circle',
    warning: 'exclamation-triangle',
    info: 'info-circle'
  };
  
  notif.innerHTML = `
    <div class="d-flex align-items-center">
      <i class="fas fa-${icons[type]} me-3 fa-lg"></i>
      <div style="flex:1">${message}</div>
      <button type="button" class="btn-close btn-close-white ms-3" onclick="this.parentElement.parentElement.remove()"></button>
    </div>
  `;
  
  document.body.appendChild(notif);
  setTimeout(() => notif.remove(), 5000);
}

/* ========== SISTEMA DE TOKENS ========== */
function activarPremium(token) {
  const tokens = JSON.parse(localStorage.getItem('optim_tokens_v2')) || [];
  const tokenData = tokens.find(t => t.token === token);
  
  if (!tokenData) {
    showNotification('Token no encontrado', 'error');
    return;
  }
  
  // Verificar expiraci√≥n
  const expires = new Date(tokenData.expires);
  const now = new Date();
  
  if (now > expires) {
    showNotification('Token expirado', 'error');
    return;
  }
  
  // Guardar acceso del usuario
  localStorage.setItem('optim_user_access', JSON.stringify({
    token: token,
    plan: tokenData.plan,
    email: tokenData.email,
    activated: new Date().toISOString(),
    expires: tokenData.expires
  }));
  
  // Mostrar contenido premium
  document.getElementById('premiumContent').style.display = 'block';
  document.getElementById('currentToken').textContent = token;
  document.getElementById('currentPlan').textContent = tokenData.plan === 'plus' ? 'Plus' : 'Elite';
  document.getElementById('expirationDate').textContent = new Date(tokenData.expires).toLocaleDateString('es-ES');
  
  showNotification('Premium activado correctamente!', 'success');
  closeCheckout();
  
  // Scroll a contenido premium
  document.getElementById('premiumContent').scrollIntoView({ behavior: 'smooth' });
}

/* ========== ADMIN PANEL ========== */
function openAdminPanel() { 
  document.getElementById('adminPanel').style.display = 'flex'; 
}

function closeAdmin() { 
  document.getElementById('adminPanel').style.display = 'none'; 
  document.getElementById('adminActions').style.display = 'none'; 
}

function loginAdmin() { 
  const pass = document.getElementById('adminPass').value; 
  if(pass === 'admin-optim-2025') { // Cambiar en producci√≥n
    document.getElementById('adminActions').style.display = 'block'; 
    showAdminTab('tokens');
    loadTokensList(); 
    loadOrdersList();
  } else { 
    showNotification('Contrase√±a incorrecta', 'error');
  }
}

function showAdminTab(tabName) {
  // Ocultar todas las tabs
  ['tokens', 'orders', 'products', 'settings'].forEach(tab => {
    document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).style.display = 'none';
  });
  
  // Mostrar tab seleccionada
  document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
}

function loadTokensList() { 
  const tokens = JSON.parse(localStorage.getItem('optim_tokens_v2')) || [];
  const list = tokens.map(t => `${t.token} (${t.plan}) - ${t.email} - ${new Date(t.expires).toLocaleDateString()}`).join('\n');
  document.getElementById('tokensList').textContent = list || '(vac√≠o)'; 
}

function loadOrdersList() {
  const orders = JSON.parse(localStorage.getItem('optim_orders')) || [];
  const container = document.getElementById('ordersList');
  
  if (orders.length === 0) {
    container.innerHTML = '<div class="text-center py-2 small-muted">No hay pedidos</div>';
    return;
  }
  
  let html = '';
  orders.forEach(order => {
    html += `
      <div class="border-bottom border-secondary pb-2 mb-2">
        <div class="d-flex justify-content-between">
          <strong>${order.id}</strong>
          <span class="badge ${order.status === 'completed' ? 'bg-success' : 'bg-warning'}">${order.status}</span>
        </div>
        <div class="small-muted">${order.email}</div>
        <div class="small">$${order.total} - ${order.method || 'manual'}</div>
        <div class="small">${new Date(order.fecha).toLocaleDateString()}</div>
        ${order.token ? `<div class="small font-monospace">Token: ${order.token}</div>` : ''}
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function generarToken() { 
  const label = document.getElementById('newTokenInput').value.trim() || generarTokenPremium();
  const plan = document.getElementById('tokenPlan').value;
  
  const tokens = JSON.parse(localStorage.getItem('optim_tokens_v2')) || [];
  tokens.push({
    token: label,
    plan: plan,
    email: 'admin-generated',
    created: new Date().toISOString(),
    expires: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
  });
  
  localStorage.setItem('optim_tokens_v2', JSON.stringify(tokens));
  loadTokensList();
  showNotification('Token generado: ' + label, 'success');
}

function exportTokens() { 
  const tokens = localStorage.getItem('optim_tokens_v2') || '[]'; 
  const blob = new Blob([tokens], {type:'application/json'}); 
  const url = URL.createObjectURL(blob); 
  const a = document.createElement('a'); 
  a.href = url; 
  a.download = 'optim_tokens.json'; 
  a.click(); 
  URL.revokeObjectURL(url); 
  showNotification('Tokens exportados', 'success');
}

function exportOrders() {
  const orders = JSON.parse(localStorage.getItem('optim_orders')) || [];
  if (orders.length === 0) {
    showNotification('No hay pedidos para exportar', 'warning');
    return;
  }
  
  const csv = 'ID,Email,Total,M√©todo,Fecha,Estado,Token\n' +
    orders.map(o => 
      `"${o.id}","${o.email}",${o.total},"${o.method || ''}","${o.fecha}","${o.status}","${o.token || ''}"`
    ).join('\n');
  
  const blob = new Blob([csv], {type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'optim_orders.csv';
  a.click();
  URL.revokeObjectURL(url);
  showNotification('Pedidos exportados', 'success');
}

function clearTokens() { 
  if(confirm('¬øBorrar todos los tokens?')) { 
    localStorage.removeItem('optim_tokens_v2'); 
    loadTokensList(); 
    showNotification('Tokens eliminados', 'info');
  }
}

function clearOrders() {
  if(confirm('¬øBorrar todos los pedidos?')) {
    localStorage.removeItem('optim_orders');
    loadOrdersList();
    showNotification('Pedidos eliminados', 'info');
  }
}

/* ========== INICIALIZACI√ìN ========== */
window.addEventListener('load', () => {
  // Inicializar productos
  renderProductos();
  
  // Inicializar carrito
  actualizarCarrito();
  
  // Verificar acceso premium
  const userAccess = JSON.parse(localStorage.getItem('optim_user_access'));
  if (userAccess && userAccess.token) {
    const tokens = JSON.parse(localStorage.getItem('optim_tokens_v2')) || [];
    const tokenData = tokens.find(t => t.token === userAccess.token);
    
    if (tokenData) {
      const expires = new Date(tokenData.expires);
      if (new Date() <= expires) {
        document.getElementById('premiumContent').style.display = 'block';
        document.getElementById('currentToken').textContent = userAccess.token;
        document.getElementById('currentPlan').textContent = userAccess.plan === 'plus' ? 'Plus' : 'Elite';
        document.getElementById('expirationDate').textContent = new Date(tokenData.expires).toLocaleDateString('es-ES');
      }
    }
  }
  
  // Event listeners
  document.getElementById('openAdminBtn').addEventListener('click', openAdminPanel);
  document.getElementById('openMemberBtn').addEventListener('click', () => {
    document.getElementById('membresias').scrollIntoView({behavior:'smooth'});
  });
  document.getElementById('cartBtn').addEventListener('click', toggleCart);
  document.getElementById('ctaLauncher').addEventListener('click', openLauncherUI);
  document.getElementById('ctaExplore').addEventListener('click', () => {
    document.getElementById('tienda').scrollIntoView({behavior:'smooth'});
  });
  
  // Inicializar b√∫squeda
  document.getElementById('searchInput').addEventListener('input', function(e) {
    const query = e.target.value.toLowerCase();
    const productos = document.querySelectorAll('.col-md-6.col-lg-3');
    
    productos.forEach(producto => {
      const text = producto.textContent.toLowerCase();
      producto.style.display = text.includes(query) ? 'block' : 'none';
    });
  });
});

/* ========== FUNCIONES EXISTENTES (para compatibilidad) ========== */
function openLauncherUI(){ 
  document.getElementById('launcherUI').style.display='block'; 
}

function closeLauncherUI(){ 
  document.getElementById('launcherUI').style.display='none'; 
}

function optimizarSistema(){ 
  alert('Optimizando sistema... (simulaci√≥n).'); 
}
</script>
</body>
</html>




