<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OptiM v1 Beta - Programas Mat√≠as Taibo</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<meta name="theme-color" content="#0f1724">
<style>
:root{--accent1:#ff6b6b;--accent2:#feca57}
*{box-sizing:border-box}
body{font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;margin:0;background:linear-gradient(135deg,#081421 0%,#072033 100%);color:#e6eef8;min-height:100vh}
.navbar{backdrop-filter:blur(8px);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
.brand{font-weight:800}
.hero{padding:80px 20px;text-align:center;background:linear-gradient(135deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:18px;margin:24px auto;width:92%;box-shadow:0 20px 60px rgba(2,6,23,0.6)}
.lead{color:var(--accent2)}
.search-container{max-width:820px;margin:20px auto}
.section-title{font-size:1.8rem;margin-bottom:18px}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;border:1px solid rgba(255,255,255,0.03);color:#eaf6ff}
.btn-primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;border-radius:999px;padding:10px 20px;font-weight:700}
.btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.06);border-radius:999px}
.launcher{background:linear-gradient(135deg,#1f005c,#5b0060);padding:24px;border-radius:12px;margin-top:22px}
.pulse{animation:pulse 2.2s infinite}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
.footer{background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(0,0,0,0.9));padding:30px;text-align:center;margin-top:40px}
.glass-card{background:rgba(255,255,255,0.02);padding:16px;border-radius:12px}
.login-card{width:480px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.15));padding:20px;border-radius:12px}
.muted{color:rgba(255,255,255,0.65)}
.small-muted{color:rgba(255,255,255,0.5);font-size:0.9rem}
.payment-modal{position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:10000;display:flex;align-items:center;justify-content:center;padding:20px}
.payment-card{width:100%;max-width:500px;background:linear-gradient(180deg,rgba(30,30,40,0.95),rgba(15,15,25,0.98));border-radius:16px;padding:25px;border:1px solid rgba(255,255,255,0.05)}
.token-display{background:linear-gradient(90deg,rgba(255,107,107,0.1),rgba(254,202,87,0.1));padding:15px;border-radius:10px;margin:15px 0;font-family:monospace;font-size:1.1rem;text-align:center;letter-spacing:1px}
.success-check{color:#4caf50;font-size:3rem;margin:20px 0}
.payment-step{padding:12px;border-left:3px solid var(--accent1);margin:10px 0;background:rgba(255,255,255,0.02)}
@media (max-width:768px){.hero{padding:40px 12px}.login-card{width:100%}.payment-card{padding:15px}}
</style>
</head>
<body>

<!-- NAV -->
<nav class="navbar navbar-expand-lg navbar-dark px-4">
  <div class="container-fluid">
    <a class="navbar-brand brand text-light"><i class="fas fa-bolt"></i> OptiM</a>
    <div class="d-flex gap-2">
      <button class="btn btn-outline text-light" id="openAdminBtn"><i class="fas fa-tools"></i> Admin</button>
      <button class="btn btn-outline text-light" id="openMemberBtn"><i class="fas fa-crown"></i> Membres√≠a</button>
      <a class="btn btn-outline text-light" href="#contacto-info"><i class="fas fa-envelope"></i> Contacto</a>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="hero container">
  <h1 class="display-5">OptiM ‚Äî v1 Beta <small class="small-muted">(2025) ‚Äî Creado por Mat√≠as Taibo</small></h1>
  <p class="lead">Tu hub de utilidades para Windows: optimizadores, herramientas y el launcher <strong>Grimoire Rev</strong> (para AQW). Sitio & sistema listo para aceptar pagos y emitir tokens.</p>
  <div class="search-container">
    <input id="searchInput" class="form-control form-control-lg" placeholder="Buscar programas, apps o funciones..." aria-label="Buscar programas">
  </div>
  <div class="d-flex justify-content-center gap-3 mt-3">
    <a class="btn btn-primary" id="ctaLauncher"><i class="fas fa-magic"></i> Abrir Grimoire Rev</a>
    <a class="btn btn-outline text-light" id="ctaExplore"><i class="fas fa-compass"></i> Explorar Apps</a>
  </div>
</section>

<!-- LAUNCHER -->
<div class="container mt-4">
  <div class="launcher d-flex flex-column align-items-center text-light">
    <h3><i class="fas fa-rocket"></i> Grimoire Rev ‚Äî Mejorado (AQW)</h3>
    <p class="small-muted">Launcher dedicado para mejorar la experiencia de AQW: m√≥dulos de optimizaci√≥n, skins y arranque r√°pido. (Integrado en OptiM).</p>
    <div class="d-flex gap-2 flex-wrap justify-content-center mt-3">
      <button class="btn btn-primary" id="openLauncherUI"><i class="fas fa-desktop"></i> Abrir Launcher</button>
      <button class="btn btn-outline text-light" id="openSettings"><i class="fas fa-sliders-h"></i> Ajustes</button>
    </div>
  </div>
</div>

<!-- PROGRAMAS GRID -->
<section class="container py-5" id="programas">
  <h2 class="section-title">Programas & Apps</h2>
  <div class="row g-4" id="programasContainer"></div>
</section>

<!-- APPS FUTURAS -->
<section class="container py-3">
  <h2 class="section-title">Apps Futuras</h2>
  <div class="row g-4">
    <div class="col-md-4"><div class="card p-3"><h5><i class="fas fa-headphones"></i> Reproductor de M√∫sica Ultra</h5><p class="muted">Ecualizador, playlists IA y visualizadores WebGL.</p></div></div>
    <div class="col-md-4"><div class="card p-3"><h5><i class="fas fa-share-alt"></i> NeoConnect (Red Social)</h5><p class="muted">Feed inteligente y mensajes.</p></div></div>
    <div class="col-md-4"><div class="card p-3"><h5><i class="fas fa-toolbox"></i> Toolkit Universal</h5><p class="muted">Editor, capturador, gestor de procesos y optimizadores.</p></div></div>
  </div>
</section>

<!-- MEMBERSHIP & PAYMENTS -->
<section class="container py-5" id="membresiaSection">
  <h2 class="section-title">Membres√≠a ‚Äî OptiM Access</h2>
  <div class="row">
    <div class="col-md-6">
      <div class="glass-card">
        <h4>Planes</h4>
        <div class="mt-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div>
              <strong>Free</strong>
              <div class="small-muted">Acceso b√°sico a programas</div>
              <div class="small-muted">Soporte b√°sico</div>
            </div>
            <button class="btn btn-outline text-light" onclick="seleccionarPlan('free')">Seleccionar</button>
          </div>
          
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div>
              <strong>Plus</strong>
              <div class="small-muted">$9.99 USD / mes</div>
              <div class="small-muted">Contenido beta + skins exclusivas</div>
              <div class="small-muted">Soporte prioritario</div>
            </div>
            <button class="btn btn-primary" onclick="iniciarPago('plus')">Suscribirme</button>
          </div>
          
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <strong>Elite</strong>
              <div class="small-muted">$19.99 USD / mes</div>
              <div class="small-muted">Acceso completo + todas las funciones</div>
              <div class="small-muted">Soporte VIP 24/7</div>
            </div>
            <button class="btn btn-primary" onclick="iniciarPago('elite')">Suscribirme</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="glass-card">
        <h4>Verificar Token</h4>
        <p class="small-muted mb-3">Si ya recibiste tu token, ingr√©salo aqu√≠ para acceder al contenido premium:</p>
        <div class="input-group mb-3">
          <input type="text" id="tokenInput" class="form-control" placeholder="Ej: OPTIM-ELITE-ABC123">
          <button class="btn btn-primary" onclick="verificarToken()">Verificar</button>
        </div>
        <p id="tokenMsg" class="small-muted"></p>
        
        <div class="mt-4">
          <h5>¬øProblemas con el pago?</h5>
          <p class="small-muted">Contacta directamente para pagos alternativos:</p>
          <div class="d-grid gap-2">
            <button class="btn btn-outline" onclick="contactarPago('brubank')">
              <i class="fas fa-university"></i> Brubank: <strong>grimoire.tokens</strong>
            </button>
            <button class="btn btn-outline" onclick="contactarPago('lemon')">
              <i class="fas fa-coins"></i> Lemon Cash (Crypto)
            </button>
            <button class="btn btn-outline" onclick="contactarPago('paypal')">
              <i class="fab fa-paypal"></i> PayPal Manual
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- MODAL DE PAGO -->
<div id="paymentModal" class="payment-modal" style="display:none;">
  <div class="payment-card">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4><i class="fas fa-lock"></i> Completar Pago</h4>
      <button class="btn btn-sm btn-outline text-light" onclick="cerrarModalPago()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div id="paymentSteps">
      <!-- Los pasos se cargan din√°micamente -->
    </div>
    
    <div id="paymentResult" style="display:none;">
      <!-- Resultado del pago se muestra aqu√≠ -->
    </div>
  </div>
</div>

<!-- PREMIUM CONTENT -->
<section class="container py-4" id="premiumContent" style="display:none">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="section-title mb-0">Contenido Exclusivo</h3>
    <div class="badge bg-success px-3 py-2">
      <i class="fas fa-crown me-2"></i>Premium Activo
    </div>
  </div>
  <div class="row">
    <div class="col-md-4"><div class="card p-3"> <h5>Grimoire Rev Pro</h5><p class="muted">M√≥dulos 3D y skins exclusivos.</p></div></div>
    <div class="col-md-4"><div class="card p-3"> <h5>Acceso Anticipado</h5><p class="muted">Prueba apps alpha y betas.</p></div></div>
    <div class="col-md-4"><div class="card p-3"> <h5>Experiencias Interactivas</h5><p class="muted">Mini apps WebGL y visualizaciones premium.</p></div></div>
  </div>
  
  <div class="mt-4">
    <h5>Tu Informaci√≥n Premium</h5>
    <div class="glass-card mt-3">
      <div class="row">
        <div class="col-md-6">
          <div class="mb-2">
            <small class="small-muted">Token:</small>
            <div id="currentToken" class="token-display">-</div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="mb-2">
            <small class="small-muted">Plan:</small>
            <div id="currentPlan" class="fs-5">-</div>
          </div>
        </div>
      </div>
      <div class="mt-3">
        <small class="small-muted">Expiraci√≥n:</small>
        <div id="expirationDate" class="fs-6">-</div>
      </div>
    </div>
  </div>
</section>

<!-- ADMIN PANEL (full frontend demo) -->
<div id="adminPanel" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:9999;align-items:center;justify-content:center;padding:20px">
  <div class="login-card p-4">
    <div class="d-flex justify-content-between align-items-center mb-3"><h4>Panel Admin ‚Äî OptiM</h4><small class="small-muted">Demo frontend</small></div>
    <div id="adminLoginArea">
      <input id="adminPass" class="form-control mb-2" placeholder="Contrase√±a admin" type="password" />
      <div class="d-flex gap-2 mb-3"><button class="btn btn-primary" onclick="loginAdmin()">Ingresar</button><button class="btn btn-outline" onclick="closeAdmin()">Cerrar</button></div>
    </div>

    <div id="adminActions" style="display:none">
      <h6>Generador de Tokens</h6>
      <div class="d-flex gap-2 mb-2">
        <input id="newTokenInput" class="form-control" placeholder="Etiqueta (ej: OPTIM-ELITE-2025)"/>
        <select id="tokenPlan" class="form-control" style="max-width:120px">
          <option value="plus">Plus</option>
          <option value="elite">Elite</option>
        </select>
        <button class="btn btn-primary" onclick="generarToken()">Generar</button>
      </div>
      <small class="small-muted">Tokens guardados en local (demo). Recomendado: backend para producci√≥n.</small>
      <pre id="tokensList" style="max-height:120px;overflow:auto;background:rgba(0,0,0,0.15);padding:10px;border-radius:8px;margin-top:8px"></pre>

      <hr />
      <h6>Usuarios Premium</h6>
      <div id="usersList" style="max-height:140px;overflow:auto;background:rgba(0,0,0,0.05);padding:10px;border-radius:8px"></div>
      <div class="d-flex gap-2 mt-2"><button class="btn btn-outline" onclick="exportUsers()">Exportar CSV</button><button class="btn btn-outline" onclick="clearUsers()">Limpiar</button></div>

      <hr />
      <h6>Pagos Recientes</h6>
      <div class="small-muted mb-2">Pagos procesados autom√°ticamente.</div>
      <div id="paymentsList" style="max-height:120px;overflow:auto;background:rgba(0,0,0,0.05);padding:8px;border-radius:8px"></div>

      <div class="d-flex gap-2 mt-3">
        <button class="btn btn-outline" onclick="exportTokens()">Exportar Tokens</button>
        <button class="btn btn-outline" onclick="clearTokens()">Limpiar Tokens</button>
        <button class="btn btn-primary" onclick="simularPagoBackend()">Simular Pago Backend</button>
      </div>
    </div>
  </div>
</div>

<!-- LAUNCHER UI (mini) -->
<div id="launcherUI" style="display:none;position:fixed;right:20px;bottom:20px;width:360px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.2));padding:12px;border-radius:12px;z-index:9998;box-shadow:0 12px 40px rgba(0,0,0,0.6)">
  <div class="d-flex justify-content-between align-items-center mb-2"><strong>Grimoire Rev - Launcher</strong><div><button class="btn btn-sm btn-outline" onclick="closeLauncherUI()"><i class="fas fa-times"></i></button></div></div>
  <div id="launcherApps" style="max-height:300px;overflow:auto"></div>
  <div class="mt-2 d-flex gap-2"><button class="btn btn-primary w-100" onclick="optimizarSistema()">Optimizar Ahora</button></div>
</div>

<!-- CONTACTO -->
<section id="contacto-info" class="py-5 text-center">
  <h2 class="section-title">Contacto Oficial</h2>
  <p class="small-muted mb-1">Consultas generales o soporte t√©cnico:</p>
  <p class="font-weight-bold">üìß <a href="mailto:matias.taibo2023@gmail.com" class="text-light">matias.taibo2023@gmail.com</a></p>
  <p class="font-weight-bold">üìû 3872252758 (solo emergencias o problemas no solucionables)</p>
  <p class="small-muted mt-3">Para problemas con pagos, incluir ID de transacci√≥n y correo usado.</p>
</section>

<!-- FOOTER -->
<footer class="footer">
  <div class="container d-flex justify-content-between align-items-center">
    <div>¬© 2025 OptiM ‚Äî v1 Beta ‚Äî Mat√≠as Taibo</div>
    <div>
      <a class="text-light me-2" href="#"><i class="fab fa-github"></i></a>
      <a class="text-light" href="#"><i class="fab fa-twitter"></i></a>
    </div>
  </div>
</footer>

<script>
/* ========== CONFIGURACI√ìN DEL SISTEMA ========== */
const CONFIG = {
  precios: {
    plus: 9.99,
    elite: 19.99
  },
  paypalEmail: "matias.taibo2023@gmail.com", // Reemplazar con email real de PayPal
  mercadopagoLink: "https://mpago.la/..." // Reemplazar con link real de MercadoPago
};

/* ========== DATOS Y ALMACENAMIENTO ========== */
const APPS = [
  {id:'swf',name:'Descompresor de SWF',desc:'Extrae y optimiza archivos Flash',icon:'fa-file-archive'},
  {id:'optwin',name:'Optimizador y Organizador de Windows',desc:'Limpieza profunda, IA y turbo rendimiento',icon:'fa-cogs'},
  {id:'flashg',name:'Optimizador de Juegos Flash',desc:'Acelera juegos Flash',icon:'fa-gamepad'},
  {id:'aqw',name:'Optimizador de AQW',desc:'Mejora FPS y estabilidad',icon:'fa-dungeon'},
  {id:'organ',name:'Organizador de Archivos Moderno',desc:'Clasificaci√≥n autom√°tica con IA',icon:'fa-folder-open'}
];

const TOKEN_KEY = 'optim_tokens_v2';
const USERS_KEY = 'optim_users_v2';
const PAYMENTS_KEY = 'optim_payments_v2';
const USER_ACCESS_KEY = 'optim_user_access';
const ADMIN_PASS = 'admin-optim-2025'; // CAMBIAR EN PRODUCCI√ìN

/* ========== FUNCIONES DEL SISTEMA DE PAGO ========== */
let currentPayment = null;

function iniciarPago(plan) {
  currentPayment = {
    plan: plan,
    id: 'pay_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
    amount: CONFIG.precios[plan],
    currency: 'USD',
    status: 'pending',
    timestamp: new Date().toISOString()
  };
  
  mostrarModalPago(plan);
}

function mostrarModalPago(plan) {
  const modal = document.getElementById('paymentModal');
  const steps = document.getElementById('paymentSteps');
  
  const planName = plan === 'plus' ? 'Plus' : 'Elite';
  const amount = CONFIG.precios[plan];
  
  steps.innerHTML = `
    <div class="payment-step">
      <h6><i class="fas fa-shopping-cart me-2"></i>Resumen del Pedido</h6>
      <div class="d-flex justify-content-between mt-2">
        <div>
          <div>Plan ${planName}</div>
          <small class="small-muted">Renovaci√≥n mensual</small>
        </div>
        <div class="fw-bold">$${amount} USD</div>
      </div>
    </div>
    
    <div class="payment-step mt-3">
      <h6><i class="fas fa-credit-card me-2"></i>Seleccionar M√©todo de Pago</h6>
      <div class="d-grid gap-2 mt-3">
        <button class="btn btn-primary" onclick="procesarPago('paypal')">
          <i class="fab fa-paypal me-2"></i>Pagar con PayPal
        </button>
        <button class="btn btn-primary" onclick="procesarPago('mercadopago')">
          <i class="fas fa-dollar-sign me-2"></i>Pagar con Mercado Pago
        </button>
        <button class="btn btn-outline" onclick="procesarPago('manual')">
          <i class="fas fa-exchange-alt me-2"></i>Transferencia Manual
        </button>
      </div>
    </div>
    
    <div class="alert alert-dark mt-3" style="background:rgba(255,255,255,0.03)">
      <small><i class="fas fa-shield-alt me-2"></i>Pago 100% seguro. Los tokens se generan autom√°ticamente tras confirmaci√≥n.</small>
    </div>
  `;
  
  modal.style.display = 'flex';
  document.getElementById('paymentResult').style.display = 'none';
}

function procesarPago(metodo) {
  if (!currentPayment) return;
  
  const steps = document.getElementById('paymentSteps');
  steps.innerHTML = `
    <div class="text-center py-4">
      <div class="spinner-border text-primary mb-3" role="status"></div>
      <h6>Procesando pago...</h6>
      <p class="small-muted">Redirigiendo a ${metodo === 'paypal' ? 'PayPal' : 'Mercado Pago'}...</p>
    </div>
  `;
  
  // Simulaci√≥n de procesamiento de pago
  setTimeout(() => {
    finalizarPago(metodo);
  }, 2000);
}

function finalizarPago(metodo) {
  if (!currentPayment) return;
  
  const email = prompt("Por favor, ingresa tu email para enviar el token:");
  if (!email) {
    alert("Email requerido para enviar el token.");
    mostrarModalPago(currentPayment.plan);
    return;
  }
  
  // Generar token √∫nico
  const token = generarTokenUnico(currentPayment.plan);
  
  // Guardar pago
  const payments = JSON.parse(localStorage.getItem(PAYMENTS_KEY) || '[]');
  currentPayment.email = email;
  currentPayment.method = metodo;
  currentPayment.status = 'completed';
  currentPayment.token = token;
  currentPayment.completedAt = new Date().toISOString();
  payments.push(currentPayment);
  localStorage.setItem(PAYMENTS_KEY, JSON.stringify(payments));
  
  // Guardar token
  const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  tokens.push({
    token: token,
    plan: currentPayment.plan,
    email: email,
    created: new Date().toISOString(),
    expires: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString() // 30 d√≠as
  });
  localStorage.setItem(TOKEN_KEY, JSON.stringify(tokens));
  
  // Guardar usuario
  const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
  users.push({
    email: email,
    plan: currentPayment.plan,
    token: token,
    joined: new Date().toISOString(),
    status: 'active'
  });
  localStorage.setItem(USERS_KEY, JSON.stringify(users));
  
  // Mostrar resultado
  const resultDiv = document.getElementById('paymentResult');
  resultDiv.innerHTML = `
    <div class="text-center py-4">
      <div class="success-check">
        <i class="fas fa-check-circle"></i>
      </div>
      <h4 class="mb-3">¬°Pago Exitoso!</h4>
      <p class="small-muted">Tu membres√≠a ${currentPayment.plan.toUpperCase()} ha sido activada.</p>
      
      <div class="token-display mt-3 mb-4">
        ${token}
      </div>
      
      <div class="alert alert-dark mb-3">
        <small>
          <i class="fas fa-envelope me-2"></i>
          El token tambi√©n ha sido enviado a: <strong>${email}</strong>
        </small>
      </div>
      
      <div class="d-grid gap-2">
        <button class="btn btn-primary" onclick="activarPremium('${token}')">
          <i class="fas fa-rocket me-2"></i>Activar Ahora
        </button>
        <button class="btn btn-outline" onclick="cerrarModalPago()">
          Cerrar
        </button>
      </div>
      
      <div class="mt-4 small-muted">
        <i class="fas fa-info-circle me-1"></i>
        Guarda este token en un lugar seguro. Lo necesitar√°s para futuros accesos.
      </div>
    </div>
  `;
  
  document.getElementById('paymentSteps').style.display = 'none';
  resultDiv.style.display = 'block';
  
  // Actualizar listas en admin
  if (document.getElementById('adminActions').style.display === 'block') {
    loadTokensList();
    loadUsersList();
    refreshPaymentsList();
  }
}

function generarTokenUnico(plan) {
  const prefix = plan === 'plus' ? 'OPTIM-PLUS' : 'OPTIM-ELITE';
  const random = Math.random().toString(36).substr(2, 6).toUpperCase();
  const timestamp = Date.now().toString(36).substr(-4).toUpperCase();
  return `${prefix}-${random}-${timestamp}`;
}

function cerrarModalPago() {
  document.getElementById('paymentModal').style.display = 'none';
  currentPayment = null;
}

function contactarPago(metodo) {
  const mensajes = {
    brubank: "Para pagar por Brubank, realiza una transferencia al alias: grimoire.tokens. Luego env√≠a el comprobante a matias.taibo2023@gmail.com",
    lemon: "Para pagos con crypto (Lemon Cash), contacta a matias.taibo2023@gmail.com para obtener la direcci√≥n de wallet.",
    paypal: "Para pagos manuales por PayPal, env√≠a a: matias.taibo2023@gmail.com. Incluye tu email en la nota."
  };
  
  alert(mensajes[metodo] || "Contacta a matias.taibo2023@gmail.com para instrucciones de pago.");
}

/* ========== SISTEMA DE TOKENS ========== */
function verificarToken() {
  const tokenInput = document.getElementById('tokenInput');
  const tokenMsg = document.getElementById('tokenMsg');
  const token = tokenInput.value.trim().toUpperCase();
  
  if (!token) {
    tokenMsg.innerHTML = '<span class="text-warning">Ingresa un token</span>';
    return;
  }
  
  const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  const tokenData = tokens.find(t => t.token === token);
  
  if (tokenData) {
    // Verificar expiraci√≥n
    const expires = new Date(tokenData.expires);
    const now = new Date();
    
    if (now > expires) {
      tokenMsg.innerHTML = '<span class="text-danger">Token expirado</span>';
      return;
    }
    
    // Activar premium
    activarPremium(token);
    tokenMsg.innerHTML = '<span class="text-success"><i class="fas fa-check-circle"></i> Token v√°lido</span>';
  } else {
    tokenMsg.innerHTML = '<span class="text-danger"><i class="fas fa-times-circle"></i> Token inv√°lido</span>';
  }
}

function activarPremium(token) {
  const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  const tokenData = tokens.find(t => t.token === token);
  
  if (!tokenData) return;
  
  // Guardar acceso del usuario
  localStorage.setItem(USER_ACCESS_KEY, JSON.stringify({
    token: token,
    plan: tokenData.plan,
    activated: new Date().toISOString(),
    email: tokenData.email
  }));
  
  // Mostrar contenido premium
  document.getElementById('premiumContent').style.display = 'block';
  
  // Actualizar informaci√≥n del usuario
  document.getElementById('currentToken').textContent = token;
  document.getElementById('currentPlan').textContent = tokenData.plan === 'plus' ? 'Plus' : 'Elite';
  document.getElementById('expirationDate').textContent = new Date(tokenData.expires).toLocaleDateString('es-ES');
  
  // Scroll a la secci√≥n premium
  document.getElementById('premiumContent').scrollIntoView({ behavior: 'smooth' });
  
  // Mostrar notificaci√≥n
  mostrarNotificacion('Premium activado correctamente!', 'success');
}

function mostrarNotificacion(mensaje, tipo = 'info') {
  const notif = document.createElement('div');
  notif.className = `alert alert-${tipo} position-fixed`;
  notif.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10001;
    min-width: 300px;
    backdrop-filter: blur(10px);
    background: rgba(30,30,40,0.9);
    border: 1px solid rgba(255,255,255,0.1);
  `;
  notif.innerHTML = `
    <div class="d-flex justify-content-between align-items-center">
      <span>${mensaje}</span>
      <button type="button" class="btn-close btn-close-white" onclick="this.parentElement.parentElement.remove()"></button>
    </div>
  `;
  
  document.body.appendChild(notif);
  setTimeout(() => notif.remove(), 5000);
}

/* ========== FUNCIONES EXISTENTES (modificadas) ========== */
function renderPrograms(filter=''){
  const cont = document.getElementById('programasContainer'); cont.innerHTML='';
  APPS.filter(a=>a.name.toLowerCase().includes(filter.toLowerCase())).forEach(a=>{
    const col = document.createElement('div'); col.className='col-md-6 col-lg-4';
    col.innerHTML = `<div class="card p-3 h-100 text-white"><i class="fas ${a.icon} fa-2x mb-2"></i><h5>${a.name}</h5><p class="small-muted">${a.desc}</p><div class="d-flex gap-2 mt-3"><button class='btn btn-primary' onclick="descargar('${a.id}')"><i class='fas fa-download'></i> Descargar</button><button class='btn btn-outline' onclick="abrirEnLauncher('${a.id}')">Abrir</button></div></div>`;
    cont.appendChild(col);
  });
}

// Inicializar programas
renderPrograms();

// B√∫squeda
const searchInput = document.getElementById('searchInput');
searchInput.addEventListener('input', e=> renderPrograms(e.target.value));

// Funciones de programas
function descargar(id){ 
  const userAccess = JSON.parse(localStorage.getItem(USER_ACCESS_KEY));
  if (!userAccess && (id === 'aqw' || id === 'optwin')) {
    if (!confirm("Esta funci√≥n requiere membres√≠a Plus. ¬øDeseas suscribirte?")) {
      iniciarPago('plus');
    }
    return;
  }
  alert('Simulado: Iniciando descarga del paquete: '+id); 
}

function abrirEnLauncher(id){ 
  openLauncherUI(); 
  const l = document.getElementById('launcherApps'); 
  const a = APPS.find(x=>x.id===id); 
  const el = document.createElement('div'); 
  el.className='p-2 mb-2'; 
  el.innerHTML = `<strong>${a.name}</strong><div class='small-muted'>${a.desc}</div>`; 
  l.prepend(el); 
}

function openLauncherUI(){ document.getElementById('launcherUI').style.display='block'; }
function closeLauncherUI(){ document.getElementById('launcherUI').style.display='none'; }
function optimizarSistema(){ alert('Optimizando sistema... (simulaci√≥n).'); }

/* ========== ADMIN PANEL (actualizado) ========== */
function openAdminPanel(){ document.getElementById('adminPanel').style.display='flex'; }
function closeAdmin(){ document.getElementById('adminPanel').style.display='none'; document.getElementById('adminActions').style.display='none'; }

function loginAdmin(){ 
  const pass = document.getElementById('adminPass').value; 
  if(pass===ADMIN_PASS){
    document.getElementById('adminActions').style.display='block'; 
    loadTokensList(); 
    loadUsersList(); 
    refreshPaymentsList(); 
  } else { 
    alert('Contrase√±a admin incorrecta'); 
  }
}

function generarToken(){ 
  const label = document.getElementById('newTokenInput').value.trim() || generarTokenUnico('plus');
  const plan = document.getElementById('tokenPlan').value;
  
  const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  tokens.push({
    token: label,
    plan: plan,
    email: 'admin-generated',
    created: new Date().toISOString(),
    expires: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
  });
  
  localStorage.setItem(TOKEN_KEY, JSON.stringify(tokens));
  loadTokensList();
  alert('Token generado: '+label);
}

function loadTokensList(){ 
  const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  const list = tokens.map(t => `${t.token} (${t.plan}) - ${t.email}`).join('\n');
  document.getElementById('tokensList').textContent = list || '(vac√≠o)'; 
}

function exportTokens(){ 
  const tokens = localStorage.getItem(TOKEN_KEY) || '[]'; 
  const blob = new Blob([tokens], {type:'application/json'}); 
  const url = URL.createObjectURL(blob); 
  const a = document.createElement('a'); 
  a.href = url; 
  a.download = 'optim_tokens.json'; 
  a.click(); 
  URL.revokeObjectURL(url); 
}

function clearTokens(){ 
  if(confirm('¬øBorrar todos los tokens?')){ 
    localStorage.removeItem(TOKEN_KEY); 
    loadTokensList(); 
  }
}

function loadUsersList(){ 
  const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]'); 
  const el = document.getElementById('usersList'); 
  el.innerHTML=''; 
  users.forEach(u=>{ 
    const d = document.createElement('div'); 
    d.className='p-2 mb-1'; 
    d.innerHTML = `
      <div class='d-flex justify-content-between align-items-center'>
        <div>
          <strong>${u.email}</strong>
          <div class='small-muted'>${u.plan} ‚Ä¢ ${u.token}</div>
        </div>
        <div>
          <button class='btn btn-sm btn-outline' onclick='revokeUser("${u.token}")'>Revocar</button>
        </div>
      </div>`; 
    el.appendChild(d); 
  }); 
}

function revokeUser(token){ 
  if(!confirm('¬øRevocar acceso para token '+token+'?')) return; 
  let users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]'); 
  users = users.filter(u=>u.token!==token); 
  localStorage.setItem(USERS_KEY,JSON.stringify(users)); 
  
  let tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  tokens = tokens.filter(t => t.token !== token);
  localStorage.setItem(TOKEN_KEY,JSON.stringify(tokens));
  
  loadUsersList(); 
  loadTokensList();
  alert('Acceso revocado'); 
}

function refreshPaymentsList(){ 
  const payments = JSON.parse(localStorage.getItem(PAYMENTS_KEY) || '[]'); 
  const el = document.getElementById('paymentsList'); 
  if(!el) return; 
  el.innerHTML=''; 
  payments.forEach(p=>{ 
    const d = document.createElement('div'); 
    d.className='p-2 mb-1'; 
    d.innerHTML = `
      <div class='d-flex justify-content-between align-items-center'>
        <div>
          <strong>${p.id}</strong>
          <div class='small-muted'>${p.email} ‚Äî $${p.amount} ‚Äî ${p.status}</div>
        </div>
        <div>
          <span class='badge ${p.status==='completed'?'bg-success':'bg-warning'}'>${p.status}</span>
        </div>
      </div>`; 
    el.appendChild(d); 
  }); 
}

function exportUsers(){ 
  const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]'); 
  if(!users.length) return alert('No hay usuarios'); 
  const csv = users.map(u=>`${u.token},${u.email||''},${u.plan||''},${u.joined||''},${u.status||''}`).join('\n'); 
  const blob = new Blob([csv],{type:'text/csv'}); 
  const url = URL.createObjectURL(blob); 
  const a = document.createElement('a'); 
  a.href=url; 
  a.download='optim_users.csv'; 
  a.click(); 
  URL.revokeObjectURL(url); 
}

function clearUsers(){ 
  if(confirm('¬øBorrar todos los usuarios?')){ 
    localStorage.removeItem(USERS_KEY); 
    loadUsersList(); 
  }
}

function simularPagoBackend() {
  const email = prompt("Email del usuario para simular pago:");
  if (!email) return;
  
  const plan = prompt("Plan (plus/elite):");
  if (!['plus', 'elite'].includes(plan)) return;
  
  // Simular pago
  const token = generarTokenUnico(plan);
  
  // Guardar en todas las listas
  const payments = JSON.parse(localStorage.getItem(PAYMENTS_KEY) || '[]');
  payments.push({
    id: 'sim_'+Date.now(),
    plan: plan,
    amount: CONFIG.precios[plan],
    email: email,
    method: 'simulated',
    status: 'completed',
    token: token,
    timestamp: new Date().toISOString()
  });
  localStorage.setItem(PAYMENTS_KEY, JSON.stringify(payments));
  
  const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
  tokens.push({
    token: token,
    plan: plan,
    email: email,
    created: new Date().toISOString(),
    expires: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString()
  });
  localStorage.setItem(TOKEN_KEY, JSON.stringify(tokens));
  
  const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
  users.push({
    email: email,
    plan: plan,
    token: token,
    joined: new Date().toISOString(),
    status: 'active'
  });
  localStorage.setItem(USERS_KEY, JSON.stringify(users));
  
  // Actualizar vistas
  loadTokensList();
  loadUsersList();
  refreshPaymentsList();
  
  alert(`Pago simulado exitoso!\nToken generado: ${token}\nEnviado a: ${email}`);
}

/* ========== INICIALIZACI√ìN ========== */
window.addEventListener('load', ()=>{
  // Inicializar launcher
  const l = document.getElementById('launcherApps'); 
  APPS.forEach(a=>{ 
    const el = document.createElement('div'); 
    el.className='p-2 mb-1'; 
    el.innerHTML = `
      <div class='d-flex justify-content-between align-items-center'>
        <div>
          <strong>${a.name}</strong>
          <div class='small-muted'>${a.desc}</div>
        </div>
        <div>
          <button class='btn btn-sm btn-primary' onclick="abrirEnLauncher('${a.id}')">Abrir</button>
        </div>
      </div>`; 
    l.appendChild(el);
  });
  
  // Verificar si el usuario ya tiene acceso premium
  const userAccess = JSON.parse(localStorage.getItem(USER_ACCESS_KEY));
  if (userAccess && userAccess.token) {
    // Verificar si el token a√∫n es v√°lido
    const tokens = JSON.parse(localStorage.getItem(TOKEN_KEY) || '[]');
    const tokenData = tokens.find(t => t.token === userAccess.token);
    
    if (tokenData) {
      const expires = new Date(tokenData.expires);
      const now = new Date();
      
      if (now <= expires) {
        // Token v√°lido, activar premium
        document.getElementById('premiumContent').style.display = 'block';
        document.getElementById('currentToken').textContent = userAccess.token;
        document.getElementById('currentPlan').textContent = userAccess.plan === 'plus' ? 'Plus' : 'Elite';
        document.getElementById('expirationDate').textContent = new Date(tokenData.expires).toLocaleDateString('es-ES');
      } else {
        // Token expirado
        localStorage.removeItem(USER_ACCESS_KEY);
      }
    }
  }
  
  // Cargar datos iniciales
  loadTokensList();
  loadUsersList();
  refreshPaymentsList();
});

// Event listeners
document.getElementById('openAdminBtn').addEventListener('click', openAdminPanel);
document.getElementById('openMemberBtn').addEventListener('click', ()=>{ 
  document.getElementById('membresiaSection').scrollIntoView({behavior:'smooth'}); 
});
document.getElementById('ctaLauncher').addEventListener('click', openLauncherUI);
document.getElementById('ctaExplore').addEventListener('click', ()=>{ 
  document.getElementById('programas').scrollIntoView({behavior:'smooth'}); 
});
</script>
</body>
</html>





